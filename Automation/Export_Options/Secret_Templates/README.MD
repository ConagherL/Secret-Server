# Secret Server Template Exporter/Importer ğŸš€

This PowerShell script automates retrieving **Secret Server** templates and exporting them into structured CSV files. It also includes formatting into a XML (separating folders from Secrets) It supports:
- âœ… Authenticating to **Secret Server** via OAuth2
- âœ… Retrieving **all secret templates**, including their field details (names, types, required status)
- âœ… Ensuring proper field order (Secret Name first, Folder Path last)
- âœ… Skipping CSV updates for **unchanged templates**
- âœ… Generating new CSV files for **new templates**
- âœ… Convert CSV data to XML for Secret Import
- âœ… Convert CSV data to XML for Folder Creation
- âœ… Logging **all operations** for visibility and debugging

## ğŸ“Œ Features
- **âš¡ Automated Secret Server export process**
- **ğŸ¯ Works with PowerShell 7+ (recommended)**
- **ğŸ“ CSV format is structured for direct import into Secret Server**
- **ğŸ” Dynamic field detection (supports new/updated templates)**
- **ğŸ”„ Smart CSV updates (only modifies changed templates)**
- **ğŸ“‚ Organizes CSV exports in designated folders**

---

## ğŸ“¥ **Installation & Requirements**
### âœ… **PowerShell Version**
- **PowerShell 7+** (Recommended)
- **PowerShell 5.1** (Limited support) - Some updated output will not render correctly

### âœ… **Prerequisites**
- **Internet access** (for API requests)
- **Valid Secret Server credentials** (Username & Password)
- **API access to retrieve secret templates**


---

## ğŸš€ Usage Examples

1ï¸âƒ£ Authenticate to Secret Server
```powershell
Connect-SecretServer -SecretServerUrl "https://yourserver.com" -OauthUrl "https://yourserver.com/oauth2/token"
```
2ï¸âƒ£ Initialize required output folders
```powershell
Initialize-SecretTemplateFolders -CsvDir "C:\temp\CSV_Files" -XmlDir "C:\temp\XML_Files"
```
3ï¸âƒ£ Retrieve all secret templates and fields
```powershell
Get-AllSecretTemplates -SecretServerUrl "https://yourserver.com" -OutputPath "C:\temp\SecretTemplates.json"
```
4ï¸âƒ£ Export Secret Templates to CSV
```powershell
Export-SecretTemplatesToCSV -JsonFilePath "C:\temp\SecretTemplates.json" -CsvDir "C:\temp\CSV_Files"
```
5ï¸âƒ£ Convert Secret CSVs to XML for Import
```powershell
Convert-CSVToXML
```
6ï¸âƒ£ Generate Folder Structure XML for Import
```powershell
Convert-FoldersToXML
```
7ï¸âƒ£ Run all steps automatically (Recommended)
```powershell
Invoke-FullExport
```

